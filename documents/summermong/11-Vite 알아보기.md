# Vite 알아보기

10번에서 번들러에 대해 알아보았다.
번들러는 기존 모듈 방식의 문제점을 해결할 수 있었지만, '속도'라는 치명적인 단점이 있었다.
기존에는 JS를 작성해 바로 브라우저에서 실행할 수 있었지만, 이제는 모든 파일을 '하나'로 만들어주는 작업이 필요해졌고 때문에 수정을 할 때마다 새롭게 빌드해야 했다. 그리고 이 빌드 속도는 결코 빠르지 않았다.

### esbuild

- 기존 빌드 속도보다 무려 100배나 빠른 빌드 도구
- 기존 번들러와 달리 Go로 작성되었음
  - 이게 왜 빠른 속도를 보장하는가? 기존 번들러가 사용하는 JS는 인터프리터 언어이기 때문에 프로그램 실행 시 한 줄 한 줄 기계어로 변환하는 작업이 필요하다. 반면 Go는 실행 전 컴파일 단계에서 미리 기계어로 전부 변환해놓기 때문이다. 또한 싱글 스레드 기반인 JS는 한 번에 한 파일씩 순차적으로 번들링/트랜스파일링 되지만 Go는 공유 메모리 환경 하에 멀티 스레드 기반으로 동작해 병렬 작업이 가능하다.

그럼에도 사람들은 webpack을 사용했는데... esbuild가 세상에 나왔을 때, webpack은 이제 단순한 빌드 도구가 아닌 통합 툴이 되어 있었다. 트랜스 파일링, 코드 스플리팅, 트리 쉐이킹 등등... 개발을 도와주는 통합 툴인 webpack VS 단순 빌드 도구인 esbuild의 싸움에서 esbuild는 밀리고 말았다. esbuild를 사용한 개발은 바닐라 스크립트 형태의 라이브러리만 가능했고, 프레임워크를 기반으로 한 웹 개발은 타 번들러를 사용해야 했다.

하지만 esbuild의 속도는 획기적이었기에 이를 현업에서 사용할 수 있는 Snowpack이 탄생한다.

### Snowpack

- 2020년 오픈소스 대상 1위에 빛나는 새로운 번들러
- esbuild의 문제점을 해결하기 위해 esbuild로 '빌드'하고 실제 번들은 webpack을 제공한다.
- 즉 각각의 모듈을 별도로 빌드(esbuild 사용)하고 수정이 발생하면 해당 파일만 다시 빌드해 업데이트 하는 방식을 채택했다.

이런 방식을 통해 파일 수정 시 새로고침을 하지 않고 수정된 부분만 반영하는 HMR(Hot Module Replace) 기능을 적극 제공하게 되었다.
하지만 낮은 안정성과 webpack 연동 시 발생하는 버그, loader들과 호환되지 않는 문제 등이 있었다.

이 Snowpack의 기반은 매우 좋았지만 이것을 더 간결하게 만드는 게 특기인(...) 에반 유가 Snowpack을 기반으로 새로운 빌드 툴 Vite를 만들어냈다.

### Vite

- esbuild와 브라우저 모듈을 이용한 개발모드, 개발 서버, 프록시 서버, 번들 툴, 코드 스플리팅, HMR 등 지금까지 나온 Snowpack의 컨셉과 다른 번들 툴에서 제공하는 기능을 모두 한데 스까 모은 프론트엔드 번들 도구!
- 번들 도구로 Webpack이 아닌 Rollup을 사용함
- Svelte를 만든 리치 해리스가 만든 Rollup을 메인 번들러로 택하면서 Vite는 Svelte랑 찰떡 궁합이 되었다...

---

참고

https://velog.io/@teo/vite#%ED%94%84%EB%A1%A4%EB%A1%9C%EA%B7%B8

https://wormwlrm.github.io/2020/08/12/History-of-JavaScript-Modules-and-Bundlers.html#%EB%AA%A8%EB%93%88-%EC%8B%9C%EC%8A%A4%ED%85%9C

https://velog.io/@sik02/Vite%EB%9E%80#%EF%B8%8F-%EC%8B%9C%EC%9E%91%ED%95%98%EB%A9%B0
